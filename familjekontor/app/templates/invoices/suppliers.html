{% extends "base.html" %}
{% from "macros/pagination.html" import render_pagination, sortable_header %}
{% from "macros/breadcrumbs.html" import render_breadcrumbs %}
{% block title %}Leverantörer - Familjekontor{% endblock %}
{% block breadcrumbs %}
{{ render_breadcrumbs([
    {'title': 'Start', 'url': url_for('dashboard.index')},
    {'title': 'Bokföring', 'url': url_for('accounting.index')},
    {'title': 'Leverantörer'}
]) }}
{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Leverantörer</h2>
    <a href="{{ url_for('invoices.new_supplier') }}" class="btn btn-primary"><i class="bi bi-plus-circle"></i> Ny leverantör</a>
</div>
<form class="mb-3" method="GET">
    <input type="hidden" name="sort" value="{{ sort }}">
    <input type="hidden" name="order" value="{{ order }}">
    <div class="input-group input-group-sm" style="max-width:400px;">
        <input type="text" name="search" class="form-control" placeholder="Sök namn eller org.nr..." value="{{ search }}">
        <button class="btn btn-outline-secondary" type="submit"><i class="bi bi-search"></i></button>
        {% if search %}<a href="{{ url_for('invoices.suppliers') }}" class="btn btn-outline-secondary">Rensa</a>{% endif %}
    </div>
</form>
<div class="table-responsive">
    <table class="table table-hover">
        <thead><tr>
            {{ sortable_header('Namn', 'name', sort, order, 'invoices.suppliers', search=search) }}
            {{ sortable_header('Org.nr', 'org_number', sort, order, 'invoices.suppliers', search=search) }}
            <th>Standardkonto</th>
            {{ sortable_header('Betvillkor', 'payment_terms', sort, order, 'invoices.suppliers', search=search) }}
            <th>Bankgiro</th>
        </tr></thead>
        <tbody>
            {% for s in pagination.items %}
            <tr>
                <td>{{ s.name }}</td>
                <td>{{ s.org_number or '-' }}</td>
                <td>{{ s.default_account or '-' }}</td>
                <td>{{ s.payment_terms }} dagar</td>
                <td>{{ s.bankgiro or s.plusgiro or '-' }}</td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="text-center text-muted py-4">Inga leverantörer. <a href="{{ url_for('invoices.new_supplier') }}">Lägg till leverantör</a></td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{{ render_pagination(pagination, 'invoices.suppliers', search=search, sort=sort, order=order) }}
{% endblock %}
