{% extends "base.html" %}
{% from "macros/breadcrumbs.html" import render_breadcrumbs %}
{% block title %}Skattebetalningar - PsalmGears{% endblock %}
{% block breadcrumbs %}
{{ render_breadcrumbs([
    {'title': 'Start', 'url': url_for('dashboard.index')},
    {'title': 'Rapporter'},
    {'title': 'Skatt', 'url': url_for('tax.index')},
    {'title': 'Skattebetalningar'}
]) }}
{% endblock %}
{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="bi bi-credit-card"></i> Skattebetalningar</h2>
        <p class="text-muted">{{ company.name }} - {{ year }}</p>
    </div>
    <div class="col-auto">
        <a href="{{ url_for('tax.payments_summary', year=year) }}" class="btn btn-outline-info me-2">
            <i class="bi bi-pie-chart"></i> Sammanst√§llning
        </a>
        <a href="{{ url_for('tax.payment_new') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> Ny betalning
        </a>
    </div>
</div>

<div class="mb-3">
    <form class="d-inline-flex gap-2" method="GET">
        <input type="number" name="year" value="{{ year }}" class="form-control form-control-sm" style="width:100px">
        <button type="submit" class="btn btn-sm btn-outline-secondary">Filtrera</button>
    </form>
</div>

<div class="card">
    <div class="table-responsive">
        <table class="table table-sm mb-0">
            <thead>
                <tr>
                    <th>Datum</th>
                    <th>Typ</th>
                    <th class="text-end">Belopp</th>
                    <th>Referens</th>
                    <th>Kopplad deadline</th>
                    <th>Anteckningar</th>
                </tr>
            </thead>
            <tbody>
                {% for p in payments %}
                <tr>
                    <td>{{ p.payment_date }}</td>
                    <td><span class="badge bg-secondary">{{ p.payment_type }}</span></td>
                    <td class="text-end">{{ p.amount|sek }} kr</td>
                    <td>{{ p.reference or '-' }}</td>
                    <td>{{ p.deadline.description if p.deadline else '-' }}</td>
                    <td>{{ p.notes or '-' }}</td>
                </tr>
                {% else %}
                <tr><td colspan="6" class="text-muted">Inga betalningar registrerade.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
